let pokemonRepository=(function(){let pokemonList=[];let apiUrl='https://pokeapi.co/api/v2/pokemon/?offset=0&limit=200';let elementLoadingMessage=document.querySelector('.loading-message');let pokemonItemKeys=['name','detailsUrl'];function firstLetterCaps(name){let firstLetter=name.charAt(0).toUpperCase();let restOfName=name.slice(1);return firstLetter+restOfName}function showLoadingMessage(){elementLoadingMessage.classList.remove('hidden')}function hideLoadingMessage(){elementLoadingMessage.classList.add('hidden')}function loadList(){showLoadingMessage();return fetch(apiUrl).then(function(response){return response.json();}).then(function(jsonData){jsonData.results.forEach(function(item){let pokemon={name:item.name,detailsUrl:item.url};add(pokemon)});hideLoadingMessage()}).catch(function(e){console.error(e);alert('Error fetching data from '+apiUrl+' : '+e);hideLoadingMessage()})}function loadDetails(pokemon){showLoadingMessage();let url=pokemon.detailsUrl;return fetch(url).then(function(response){return response.json();}).then(function(details){hideLoadingMessage();pokemon.imageFrontUrl=details.sprites.front_default;pokemon.imageBackUrl=details.sprites.back_default;pokemon.order=details.order;pokemon.height=details.height;pokemon.types=details.types;pokemon.abilities=details.abilities}).catch(function(e){hideLoadingMessage();console.error('pokemonRepository.loadDetails()|ERROR|'+e);alert('Error while loading Pokemon information :'+e)})}function add(item){if((typeof(item)==='object')&&(Object.keys(item).length===pokemonItemKeys.length)){let keyCompareResult=true;for(let i=0;i<pokemonItemKeys.length;i+=1){if(Object.keys(item)[i]!==pokemonItemKeys[i]){console.error('pokemonRepository.add()| Invalid key found: Object.keys(item)['+i+']!==pokemonItemKeys['+i+']: '+(Object.keys(item)[i]+'!=='+pokemonItemKeys[i]));keyCompareResult=false;break}}if(keyCompareResult){pokemonList.push(item)}else{console.error('* pokemonRepository.add() | Invalid pokemon object format, cannot add to list!');alert('Something went wrong loading the Pokemon data into list.')}}}function addListItem(pokemon){let elementPokemonList=document.querySelector('#list-for-pokemon');let listItem=document.createElement('li');listItem.classList.add('list-group-item');listItem.classList.add('border-0');listItem.classList.add('row');let button=document.createElement('button');button.innerText=firstLetterCaps(pokemon.name);button.classList.add('btn');button.classList.add('btn-outline-dark');button.classList.add('col-8');button.classList.add('col-sm-6');button.setAttribute("data-toggle","modal");button.setAttribute("data-target","#pokemonModal");listItem.appendChild(button);elementPokemonList.appendChild(listItem);addListenerToListItem(button,pokemon)}function addListenerToListItem(button,pokemon){button.addEventListener('click',function(event){showDetails(pokemon)})}function showDetails(pokemon){let modalTitle=document.querySelector('.modal-title');let modalInfo=document.querySelector('#pokemonInfo');let modalFrontImg=$('#pokemonFrontImg');let modalBackImg=$('#pokemonBackImg');modalTitle.innerText="Loading...";$('#pokemonInfo').empty();modalFrontImg.attr('src',"img/loading-spinner-32x32.gif");modalBackImg.attr('src',"img/loading-spinner-32x32.gif");loadDetails(pokemon).then(function(){modalTitle.innerText=firstLetterCaps(pokemon.name);modalFrontImg.attr('src',pokemon.imageFrontUrl);modalBackImg.attr('src',pokemon.imageBackUrl);let heightRow=document.createElement('li');heightRow.classList.add('row');let heightLabel=document.createElement('div');heightLabel.classList.add('col-6');heightLabel.classList.add('h5');heightLabel.classList.add('text-right');heightLabel.innerText='Height:';let heightValue=document.createElement('div');heightValue.classList.add('col-6');heightValue.classList.add('h5');heightValue.classList.add('text-left');heightValue.innerText=pokemon.height;heightRow.appendChild(heightLabel);heightRow.appendChild(heightValue);modalInfo.appendChild(heightRow);let typesRow=document.createElement('li');typesRow.classList.add('row');let typesLabel=document.createElement('div');typesLabel.classList.add('col-6');typesLabel.classList.add('h5');typesLabel.classList.add('text-right');typesLabel.innerText='Types:';let typesValue=document.createElement('td');typesValue.classList.add('col-6');typesValue.classList.add('h5');typesValue.classList.add('text-left');let typesObj=[];pokemon.types.forEach((item)=>{typesObj.push(firstLetterCaps(item.type.name))});typesValue.innerText=typesObj.toString().replaceAll(",",", ");typesRow.appendChild(typesLabel);typesRow.appendChild(typesValue);modalInfo.appendChild(typesRow);let abilitiesRow=document.createElement('li');abilitiesRow.classList.add('row');let abilitiesLabel=document.createElement('div');abilitiesLabel.classList.add('col-6');abilitiesLabel.classList.add('h5');abilitiesLabel.classList.add('text-right');abilitiesLabel.innerText='Abilities:';let abilitiesValue=document.createElement('td');abilitiesValue.classList.add('col-6');abilitiesValue.classList.add('h5');abilitiesValue.classList.add('text-left');let abilitiesObj=[];pokemon.abilities.forEach((item)=>{abilitiesObj.push(firstLetterCaps(item.ability.name))});abilitiesValue.innerText=abilitiesObj.toString().replaceAll(",",", ");abilitiesRow.appendChild(abilitiesLabel);abilitiesRow.appendChild(abilitiesValue);modalInfo.appendChild(abilitiesRow);});}function hideDetails(){let modalContainer=document.querySelector('#modal-container');modalContainer.classList.remove('is-visible')}function contains(pokemonName){console.log('* pokemonRepository.contains() | Function called to search for '+pokemonName);let isInListResult=[];isInListResult=pokemonList.filter(item=>item.name.toLowerCase()===pokemonName.toString().toLowerCase());console.log('* pokemonRepository.contains() | isInListResult is '+isInListResult);if(isInListResult.length>0){console.log('* pokemonRepository.contains() | '+(pokemonName).toString().toUpperCase()+' was found in the list.')}else{console.log('* pokemonRepository.contains() | '+(pokemonName).toString().toUpperCase()+' was not found in the list.')}}function getAll(){return pokemonList}window.addEventListener('keydown',(e)=>{let modalContainer=document.querySelector('#modal-container');if(e.key==='Escape'&&modalContainer.classList.contains('is-visible')){hideDetails()}});return{loadList:loadList,loadDetails:loadDetails,add:add,addListItem:addListItem,contains:contains,getAll:getAll}})();pokemonRepository.loadList().then(function(){pokemonRepository.getAll().forEach(function(pokemon){pokemonRepository.addListItem(pokemon)})}).catch(function(e){console.error('Rejected promise on loadList()|'+e);alert('Error loading data into list: '+e)});